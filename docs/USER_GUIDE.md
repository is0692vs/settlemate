# SettleMate ユーザーガイド

## はじめに

SettleMateは、友人やグループでの支出を簡単に管理できるWebアプリケーションです。このガイドでは、SettleMateの使い方を画面ごとに詳しく説明します。

## 目次

1. [アカウント登録・ログイン](#1-アカウント登録ログイン)
2. [グループの作成](#2-グループの作成)
3. [メンバーの招待](#3-メンバーの招待)
4. [支出の記録](#4-支出の記録)
5. [残高の確認](#5-残高の確認)
6. [清算の記録](#6-清算の記録)
7. [プロフィール設定](#7-プロフィール設定)
8. [PWA（アプリ化）](#8-pwaアプリ化)

---

## 1. アカウント登録・ログイン

### 初回ログイン

1. SettleMateのホームページにアクセス
2. 「ログイン」ボタンをクリック
3. 「Googleでログイン」を選択
4. Googleアカウントを選択して認証を許可

### 2回目以降

- ブラウザにセッションが保存されているため、自動的にログインされます
- セッションは30日間有効です

---

## 2. グループの作成

グループは、旅行や飲み会など、支出を共有したい単位で作成します。

### 作成手順

1. **ダッシュボードから「グループ管理」をクリック**
2. **「新規グループ作成」ボタンをクリック**
3. **グループ情報を入力**
   - **グループ名**: 「温泉旅行」「飲み会」など
   - **アイコン**: 絵文字を選択（🏨🍺など）
4. **「作成」ボタンをクリック**

作成したグループには自動的にあなたがメンバーとして追加されます。

### グループの編集

1. グループ一覧から編集したいグループをクリック
2. 「グループを編集」ボタンをクリック
3. グループ名やアイコンを変更
4. 「保存」ボタンをクリック

### グループの削除

⚠️ **注意**: グループを削除すると、そのグループに関連するすべての支出、残高、清算履歴が削除されます。

1. グループ詳細画面で「グループを削除」ボタンをクリック
2. 確認ダイアログで「削除」を選択

---

## 3. メンバーの招待

グループに友人を招待する方法は2つあります。

### 方法1: 招待リンクを共有

1. グループ詳細画面で「招待リンクをコピー」ボタンをクリック
2. LINEやメールでリンクを共有
3. 友人がリンクをクリックして参加

### 方法2: 招待コードを伝える

1. グループ詳細画面に表示されている招待コードをメモ
2. 友人に招待コードを伝える
3. 友人がSettleMateにログイン後、「招待コードで参加」から入力

### グループへの参加（招待された側）

1. 招待リンクをクリック、または「招待コードで参加」を選択
2. 必要に応じてログイン
3. 「グループに参加」ボタンをクリック

---

## 4. 支出の記録

グループで発生した支出を記録します。

### 均等割りの場合

例: ディナー代3,000円を3人で均等に分ける

1. **グループ詳細画面で「支出を追加」ボタンをクリック**
2. **支出情報を入力**
   - **支払った人**: 自分または他のメンバーを選択
   - **金額**: 3000（円）
   - **説明**: 「ディナー」（任意）
   - **参加者**: 支出を分割するメンバーを選択（複数選択可）
   - **分割方法**: 「均等割り」を選択
3. **「記録」ボタンをクリック**

結果: 各メンバーの負担額は1,000円となり、残高が自動計算されます。

### 手動での借金登録

例: AさんがBさんに5,000円を貸した場合

1. **「支出を追加」ボタンをクリック**
2. **支出情報を入力**
   - **支払った人**: Aさん
   - **金額**: 5000（円）
   - **説明**: 「立て替え」（任意）
   - **参加者**: [Aさん, Bさん] の順に選択
   - **分割方法**: 「手動借金登録」を選択
3. **「記録」ボタンをクリック**

結果: BさんがAさんに5,000円を返す必要があることが記録されます。

### 支出の編集・削除

⚠️ 支払った本人のみ編集・削除できます。

1. 支出履歴から編集したい支出をクリック
2. 「編集」または「削除」ボタンをクリック
3. 編集の場合は金額や説明を変更して「保存」

---

## 5. 残高の確認

グループ詳細画面で、誰が誰にいくら支払うべきかを確認できます。

### リスト表示

「残高」セクションに、すべての貸借関係がリストで表示されます。

例:
```
太郎 → 花子: ¥1,000
次郎 → 太郎: ¥500
```

これは、「太郎が花子に1,000円を支払う必要がある」「次郎が太郎に500円を支払う必要がある」ことを意味します。

### グラフ表示

「グラフで表示」ボタンをクリックすると、残高関係が視覚化されます。

- **ノード（丸）**: メンバー
- **エッジ（矢印）**: 支払いの方向と金額

グラフはドラッグして移動したり、ズームしたりできます。

---

## 6. 清算の記録

実際にお金を支払ったら、清算を記録します。

### 清算手順

1. **残高リストまたはグラフから「清算する」ボタンをクリック**
2. **清算情報を入力**
   - **支払先**: 自動的に設定されます
   - **金額**: 支払った金額を入力
   - **決済方法**: 以下から選択
     - 💵 現金
     - 🏦 銀行振込
     - 💳 PayPay
     - 📱 LINE Pay
   - **メモ**: 任意（例: 「PayPayで送金しました」）
3. **「清算を記録」ボタンをクリック**

結果: 残高が自動的に更新され、完済した場合は残高リストから削除されます。

### 清算履歴の確認

グループ詳細画面の「清算履歴」セクションで、過去の清算を確認できます。

### 清算の取り消し

⚠️ 清算を記録した本人のみ削除できます。

1. 清算履歴から削除したい清算をクリック
2. 「削除」ボタンをクリック
3. 確認ダイアログで「削除」を選択

結果: 残高が元に戻ります。

---

## 7. プロフィール設定

### 表示名の設定

ダッシュボードから「マイページ」を選択し、以下を設定できます。

#### 表示名

Googleアカウントの名前とは別に、SettleMate内での表示名を設定できます。

1. 「表示名」欄に任意の名前を入力
2. 「保存」ボタンをクリック

### 対応決済方法の設定

自分が対応できる決済方法を設定しておくと、清算時に相手が参考にできます。

1. 対応している決済方法にチェックを入れる
   - ✅ 現金
   - ✅ 銀行振込
   - ✅ PayPay
   - ✅ LINE Pay
2. 「保存」ボタンをクリック

---

## 8. PWA（アプリ化）

SettleMateはPWA（Progressive Web App）に対応しており、スマートフォンのホーム画面に追加してアプリのように使えます。

### iOSでの追加方法

1. SafariでSettleMateを開く
2. 画面下部の「共有」ボタン（□↑）をタップ
3. 「ホーム画面に追加」を選択
4. 「追加」をタップ

### Androidでの追加方法

1. ChromeでSettleMateを開く
2. 画面右上のメニュー（⋮）をタップ
3. 「ホーム画面に追加」を選択
4. 「追加」をタップ

または、画面下部に表示されるバナーから「インストール」を選択します。

### アプリ化のメリット

- アプリアイコンからすぐに起動できる
- アドレスバーが非表示になり、画面を広く使える
- 一部の機能がオフラインでも利用可能

詳しくは [PWA.md](PWA.md) を参照してください。

---

## よくある質問（FAQ）

### Q1: グループから退出したい

現在、グループからの自主退出機能は未実装です。グループの作成者に削除してもらうか、グループ自体を削除してください。

### Q2: 複数のグループに参加できますか？

はい、制限なく複数のグループに参加できます。

### Q3: 支出を記録した後に金額を変更できますか？

はい、支払った本人であれば編集・削除が可能です。

### Q4: 決済方法を追加してほしい

プロフィール設定で以下の決済方法に対応しています:
- 現金
- 銀行振込
- PayPay
- LINE Pay

その他の決済方法が必要な場合は、GitHubのissueでリクエストしてください。

### Q5: データはどこに保存されますか？

すべてのデータは安全なクラウドデータベース（PostgreSQL）に保存されます。

### Q6: 招待リンクが無効になることはありますか？

招待リンクは永続的に有効です。ただし、グループが削除されると無効になります。

### Q7: 外貨での支出記録はできますか？

現在は日本円のみ対応しています。外貨対応は将来的に検討しています。

---

## トラブルシューティング

### ログインできない

1. Googleアカウントで正しく認証されているか確認
2. ブラウザのCookieが有効になっているか確認
3. プライベートブラウジングモードの場合は通常モードで試す

### グループが表示されない

1. 画面を更新（F5またはCommand+R）
2. 正しいアカウントでログインしているか確認

### 残高が更新されない

1. 画面を更新
2. 支出が正しく記録されているか確認
3. それでも解決しない場合はサポートに連絡

---

## サポート

問題が解決しない場合や機能リクエストがある場合は、以下の方法でお問い合わせください:

- **GitHub Issues**: [https://github.com/is0692vs/settlemate/issues](https://github.com/is0692vs/settlemate/issues)
- **開発者**: [@is0692vs](https://github.com/is0692vs)

---

## 使用例: 旅行での利用

### シナリオ

太郎、花子、次郎の3人で温泉旅行に行く場合の使い方を紹介します。

#### 1. 事前準備（出発前）

1. **太郎がグループを作成**
   - グループ名: 「温泉旅行」
   - アイコン: 🏨

2. **花子と次郎を招待**
   - LINEグループで招待リンクを共有
   - 2人がグループに参加

#### 2. 旅行中

**Day 1**

- **太郎が宿泊費を支払い**: 30,000円（3人分）
  - 支払った人: 太郎
  - 金額: 30000
  - 参加者: 太郎、花子、次郎
  - 分割方法: 均等割り
  - → 各自10,000円の負担

- **花子が夕食代を支払い**: 9,000円（3人分）
  - 支払った人: 花子
  - 金額: 9000
  - 参加者: 太郎、花子、次郎
  - 分割方法: 均等割り
  - → 各自3,000円の負担

**Day 2**

- **次郎が朝食代を支払い**: 3,000円（3人分）
  - 支払った人: 次郎
  - 金額: 3000
  - 参加者: 太郎、花子、次郎
  - 分割方法: 均等割り
  - → 各自1,000円の負担

- **太郎がガソリン代を支払い**: 5,000円（3人分）
  - 支払った人: 太郎
  - 金額: 5000
  - 参加者: 太郎、花子、次郎
  - 分割方法: 均等割り
  - → 各自約1,667円の負担

#### 3. 旅行後（清算）

グラフや残高リストで確認すると、以下のようになっています:

```
花子 → 太郎: ¥12,667
次郎 → 太郎: ¥13,667
```

**花子がPayPayで太郎に送金**
- 金額: 12667
- 決済方法: PayPay
- → 花子の残高が0円に

**次郎が現金で太郎に支払い**
- 金額: 13667
- 決済方法: 現金
- → 次郎の残高が0円に

清算完了！🎉

---

SettleMateを使って、楽しくスムーズなグループ活動をお楽しみください！
